bundle:
  name: dbx_poc

variables:
  brand_configs:
    description: "List of brands and collection IDs"
    default: []

targets:
  dev:
    default: true
    workspace:
      root_path: /Workspace/Shared/mars-odai-test/notebooks

    variables:
      brand_configs:
        - brand: "snickers"
          collection_id: "5e230de5cee846f18c90b39c00e94f56"

        - brand: "skitlles"
          collection_id: "4de00c04d79442cfa6b8b39a00801e9a"


resources:
  jobs:
    poc_ingest_job:
      for_each:
        cfg: ${var.brand_configs}

      name: ingest_${each.value.brand}

      tasks:
        - task_key: run_notebook
          notebook_task:
            notebook_path: notebooks/Aprimo_to_dbx- Dev_Final.ipynb
            base_parameters:
              brand_name: ${each.value.brand}
              collection_id: ${each.value.collection_id}

      tags:
        env: dev
        project: aprimo
        brand: ${each.value.brand}
